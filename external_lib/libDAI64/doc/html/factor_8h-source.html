<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>libDAI: include/dai/factor.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_788dec3f6cf4a9394427425a1f1fc617.html">include</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_240a4880a980807f35cfca6c0dacf24f.html">dai</a>
  </div>
</div>
<div class="contents">
<h1>factor.h</h1><a href="factor_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*  Copyright (C) 2006-2008  Joris Mooij  [joris dot mooij at tuebingen dot mpg dot de]</span>
<a name="l00002"></a>00002 <span class="comment">    Radboud University Nijmegen, The Netherlands /</span>
<a name="l00003"></a>00003 <span class="comment">    Max Planck Institute for Biological Cybernetics, Germany</span>
<a name="l00004"></a>00004 <span class="comment"></span>
<a name="l00005"></a>00005 <span class="comment">    Copyright (C) 2002  Martijn Leisink  [martijn@mbfys.kun.nl]</span>
<a name="l00006"></a>00006 <span class="comment">    Radboud University Nijmegen, The Netherlands</span>
<a name="l00007"></a>00007 <span class="comment"></span>
<a name="l00008"></a>00008 <span class="comment">    This file is part of libDAI.</span>
<a name="l00009"></a>00009 <span class="comment"></span>
<a name="l00010"></a>00010 <span class="comment">    libDAI is free software; you can redistribute it and/or modify</span>
<a name="l00011"></a>00011 <span class="comment">    it under the terms of the GNU General Public License as published by</span>
<a name="l00012"></a>00012 <span class="comment">    the Free Software Foundation; either version 2 of the License, or</span>
<a name="l00013"></a>00013 <span class="comment">    (at your option) any later version.</span>
<a name="l00014"></a>00014 <span class="comment"></span>
<a name="l00015"></a>00015 <span class="comment">    libDAI is distributed in the hope that it will be useful,</span>
<a name="l00016"></a>00016 <span class="comment">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00017"></a>00017 <span class="comment">    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00018"></a>00018 <span class="comment">    GNU General Public License for more details.</span>
<a name="l00019"></a>00019 <span class="comment"></span>
<a name="l00020"></a>00020 <span class="comment">    You should have received a copy of the GNU General Public License</span>
<a name="l00021"></a>00021 <span class="comment">    along with libDAI; if not, write to the Free Software</span>
<a name="l00022"></a>00022 <span class="comment">    Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA</span>
<a name="l00023"></a>00023 <span class="comment">*/</span>
<a name="l00024"></a>00024 
<a name="l00025"></a>00025 
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 
<a name="l00030"></a>00030 <span class="preprocessor">#ifndef __defined_libdai_factor_h</span>
<a name="l00031"></a>00031 <span class="preprocessor"></span><span class="preprocessor">#define __defined_libdai_factor_h</span>
<a name="l00032"></a>00032 <span class="preprocessor"></span>
<a name="l00033"></a>00033 
<a name="l00034"></a>00034 <span class="preprocessor">#include &lt;iostream&gt;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &lt;cmath&gt;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &lt;<a class="code" href="prob_8h.html" title="Defines TProb&amp;lt;T&amp;gt; and Prob classes.">dai/prob.h</a>&gt;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &lt;<a class="code" href="varset_8h.html" title="Defines VarSet class.">dai/varset.h</a>&gt;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &lt;<a class="code" href="index_8h.html" title="Defines the IndexFor, MultiFor, Permute and State classes.">dai/index.h</a>&gt;</span>
<a name="l00039"></a>00039 
<a name="l00040"></a>00040 
<a name="l00041"></a>00041 <span class="keyword">namespace </span>dai {
<a name="l00042"></a>00042 
<a name="l00043"></a>00043 
<a name="l00044"></a>00044 <span class="comment">// predefine TFactor&lt;T&gt; class</span>
<a name="l00045"></a><a class="code" href="namespacedai.html#7515abf9952cd312e95a34ada0670e85">00045</a> <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="keyword">class      </span><a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor</a>;
<a name="l00046"></a>00046 
<a name="l00047"></a>00047 
<a name="l00049"></a>00049 <span class="keyword">typedef</span> <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;Real&gt;</a>           <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">Factor</a>;
<a name="l00050"></a>00050 
<a name="l00051"></a>00051 
<a name="l00053"></a>00053 
<a name="l00065"></a><a class="code" href="classdai_1_1TFactor.html">00065</a> <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keyword">class </span><a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor</a> {
<a name="l00066"></a>00066     <span class="keyword">private</span>:
<a name="l00067"></a>00067         <a class="code" href="classdai_1_1VarSet.html" title="Represents a set of variables.">VarSet</a>      _vs;
<a name="l00068"></a>00068         <a class="code" href="classdai_1_1TProb.html" title="Represents a probability measure on a finite outcome space (i.e., corresponding to...">TProb&lt;T&gt;</a>    _p;
<a name="l00069"></a>00069 
<a name="l00070"></a>00070     <span class="keyword">public</span>:
<a name="l00072"></a><a class="code" href="classdai_1_1TFactor.html#da0bedb7a343b45ebcfcbfc0b6c18334">00072</a>         <a class="code" href="classdai_1_1TFactor.html#da0bedb7a343b45ebcfcbfc0b6c18334" title="Construct Factor with empty VarSet.">TFactor</a> ( <a class="code" href="namespacedai.html#e7d0472fdc89a8635825d01940e91cbf" title="Real number (alias for double, could be changed to long double if necessary).">Real</a> <a class="code" href="classdai_1_1TFactor.html#c742180c0abe1be45fbf3208f7014a1b" title="Returns const reference to probability entries.">p</a> = 1.0 ) : _vs(), _p(1,<a class="code" href="classdai_1_1TFactor.html#c742180c0abe1be45fbf3208f7014a1b" title="Returns const reference to probability entries.">p</a>) {}
<a name="l00073"></a>00073 
<a name="l00075"></a><a class="code" href="classdai_1_1TFactor.html#8752572e0465b031aa072d3816323509">00075</a>         <a class="code" href="classdai_1_1TFactor.html#da0bedb7a343b45ebcfcbfc0b6c18334" title="Construct Factor with empty VarSet.">TFactor</a>( <span class="keyword">const</span> <a class="code" href="classdai_1_1VarSet.html" title="Represents a set of variables.">VarSet</a>&amp; ns ) : _vs(ns), _p(_vs.nrStates()) {}
<a name="l00076"></a>00076         
<a name="l00078"></a><a class="code" href="classdai_1_1TFactor.html#2d587d2014f55004765685ade322f334">00078</a>         <a class="code" href="classdai_1_1TFactor.html#da0bedb7a343b45ebcfcbfc0b6c18334" title="Construct Factor with empty VarSet.">TFactor</a>( <span class="keyword">const</span> <a class="code" href="classdai_1_1VarSet.html" title="Represents a set of variables.">VarSet</a>&amp; ns, <a class="code" href="namespacedai.html#e7d0472fdc89a8635825d01940e91cbf" title="Real number (alias for double, could be changed to long double if necessary).">Real</a> <a class="code" href="classdai_1_1TFactor.html#c742180c0abe1be45fbf3208f7014a1b" title="Returns const reference to probability entries.">p</a> ) : _vs(ns), _p(_vs.nrStates(),p) {}
<a name="l00079"></a>00079         
<a name="l00081"></a><a class="code" href="classdai_1_1TFactor.html#00bb2720d6975adf3c58328be4b96bd4">00081</a>         <a class="code" href="classdai_1_1TFactor.html#da0bedb7a343b45ebcfcbfc0b6c18334" title="Construct Factor with empty VarSet.">TFactor</a>( <span class="keyword">const</span> <a class="code" href="classdai_1_1VarSet.html" title="Represents a set of variables.">VarSet</a>&amp; ns, <span class="keyword">const</span> <a class="code" href="namespacedai.html#e7d0472fdc89a8635825d01940e91cbf" title="Real number (alias for double, could be changed to long double if necessary).">Real</a> *<a class="code" href="classdai_1_1TFactor.html#c742180c0abe1be45fbf3208f7014a1b" title="Returns const reference to probability entries.">p</a> ) : _vs(ns), _p(_vs.nrStates(),p) {}
<a name="l00082"></a>00082 
<a name="l00084"></a><a class="code" href="classdai_1_1TFactor.html#e85b382ef05f8f659e13e2b368ad27e2">00084</a>         <a class="code" href="classdai_1_1TFactor.html#da0bedb7a343b45ebcfcbfc0b6c18334" title="Construct Factor with empty VarSet.">TFactor</a>( <span class="keyword">const</span> <a class="code" href="classdai_1_1VarSet.html" title="Represents a set of variables.">VarSet</a>&amp; ns, <span class="keyword">const</span> <a class="code" href="classdai_1_1TProb.html" title="Represents a probability measure on a finite outcome space (i.e., corresponding to...">TProb&lt;T&gt;</a>&amp; <a class="code" href="classdai_1_1TFactor.html#c742180c0abe1be45fbf3208f7014a1b" title="Returns const reference to probability entries.">p</a> ) : _vs(ns), _p(p) {
<a name="l00085"></a>00085 <span class="preprocessor">#ifdef DAI_DEBUG</span>
<a name="l00086"></a>00086 <span class="preprocessor"></span>            assert( _vs.<a class="code" href="classdai_1_1VarSet.html#adfd4d43a9a521f8738e9507682440d3" title="Calculates the product of the number of states of all variables in this VarSet.">nrStates</a>() == _p.size() );
<a name="l00087"></a>00087 <span class="preprocessor">#endif</span>
<a name="l00088"></a>00088 <span class="preprocessor"></span>        }
<a name="l00089"></a>00089         
<a name="l00091"></a><a class="code" href="classdai_1_1TFactor.html#f3c3586003e78bd4b82fb44b3d06775c">00091</a>         <a class="code" href="classdai_1_1TFactor.html#da0bedb7a343b45ebcfcbfc0b6c18334" title="Construct Factor with empty VarSet.">TFactor</a>( <span class="keyword">const</span> <a class="code" href="classdai_1_1Var.html" title="Represents a discrete random variable.">Var</a>&amp; n ) : _vs(n), _p(n.<a class="code" href="classdai_1_1TFactor.html#57d676927a5dcacbef47f564c46bf128" title="Returns the number of possible joint states of the variables.">states</a>()) {}
<a name="l00092"></a>00092 
<a name="l00094"></a><a class="code" href="classdai_1_1TFactor.html#440fb43645f78e6c1471b9b489e74847">00094</a>         <a class="code" href="classdai_1_1TFactor.html#da0bedb7a343b45ebcfcbfc0b6c18334" title="Construct Factor with empty VarSet.">TFactor</a>( <span class="keyword">const</span> <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> &amp;x ) : _vs(x._vs), _p(x._p) {}
<a name="l00095"></a>00095         
<a name="l00097"></a><a class="code" href="classdai_1_1TFactor.html#bbf1478950a7bc11f9ac4b5e5081e046">00097</a>         <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> &amp; <a class="code" href="classdai_1_1TFactor.html#bbf1478950a7bc11f9ac4b5e5081e046" title="Assignment operator.">operator= </a>(<span class="keyword">const</span> <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> &amp;x) {
<a name="l00098"></a>00098             <span class="keywordflow">if</span>( <span class="keyword">this</span> != &amp;x ) {
<a name="l00099"></a>00099                 _vs = x.<a class="code" href="classdai_1_1TFactor.html#b4ba88e0b89d62aa7709852a6cafa9e6">_vs</a>;
<a name="l00100"></a>00100                 _p  = x.<a class="code" href="classdai_1_1TFactor.html#34ea1a358f9248fdcd1d0b68b1313294">_p</a>;
<a name="l00101"></a>00101             }
<a name="l00102"></a>00102             <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00103"></a>00103         }
<a name="l00104"></a>00104 
<a name="l00106"></a><a class="code" href="classdai_1_1TFactor.html#c742180c0abe1be45fbf3208f7014a1b">00106</a>         <span class="keyword">const</span> <a class="code" href="classdai_1_1TProb.html" title="Represents a probability measure on a finite outcome space (i.e., corresponding to...">TProb&lt;T&gt;</a> &amp; <a class="code" href="classdai_1_1TFactor.html#c742180c0abe1be45fbf3208f7014a1b" title="Returns const reference to probability entries.">p</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _p; }
<a name="l00108"></a><a class="code" href="classdai_1_1TFactor.html#ba85b145db1c3b72978e11fb385659e1">00108</a>         <a class="code" href="classdai_1_1TProb.html" title="Represents a probability measure on a finite outcome space (i.e., corresponding to...">TProb&lt;T&gt;</a> &amp; <a class="code" href="classdai_1_1TFactor.html#c742180c0abe1be45fbf3208f7014a1b" title="Returns const reference to probability entries.">p</a>() { <span class="keywordflow">return</span> _p; }
<a name="l00109"></a>00109 
<a name="l00111"></a><a class="code" href="classdai_1_1TFactor.html#54c575d53b8c8a6a03c26c8cdc600ce4">00111</a>         <span class="keyword">const</span> <a class="code" href="classdai_1_1VarSet.html" title="Represents a set of variables.">VarSet</a> &amp; <a class="code" href="classdai_1_1TFactor.html#54c575d53b8c8a6a03c26c8cdc600ce4" title="Returns const reference to variables.">vars</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _vs; }
<a name="l00112"></a>00112 
<a name="l00114"></a><a class="code" href="classdai_1_1TFactor.html#57d676927a5dcacbef47f564c46bf128">00114</a>         <span class="keywordtype">size_t</span> <a class="code" href="classdai_1_1TFactor.html#57d676927a5dcacbef47f564c46bf128" title="Returns the number of possible joint states of the variables.">states</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _p.size(); }
<a name="l00115"></a>00115 
<a name="l00117"></a><a class="code" href="classdai_1_1TFactor.html#22a12143c01d05a1e70ca3f92ec42595">00117</a>         T <a class="code" href="classdai_1_1TFactor.html#22a12143c01d05a1e70ca3f92ec42595" title="Returns a copy of the i&amp;#39;th probability value.">operator[] </a>(<span class="keywordtype">size_t</span> i)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _p[i]; }
<a name="l00118"></a>00118 
<a name="l00120"></a><a class="code" href="classdai_1_1TFactor.html#8be917166f0f32f2da09e09fc5fa2651">00120</a>         T&amp; <a class="code" href="classdai_1_1TFactor.html#22a12143c01d05a1e70ca3f92ec42595" title="Returns a copy of the i&amp;#39;th probability value.">operator[] </a>(<span class="keywordtype">size_t</span> i) { <span class="keywordflow">return</span> _p[i]; }
<a name="l00121"></a>00121 
<a name="l00123"></a><a class="code" href="classdai_1_1TFactor.html#949ed2c4aefdf1aadfe33d0c2dac89b3">00123</a>         <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> &amp; <a class="code" href="classdai_1_1TFactor.html#949ed2c4aefdf1aadfe33d0c2dac89b3" title="Sets all probability entries to p.">fill</a> (T <a class="code" href="classdai_1_1TFactor.html#c742180c0abe1be45fbf3208f7014a1b" title="Returns const reference to probability entries.">p</a>) { _p.fill( p ); <span class="keywordflow">return</span>(*<span class="keyword">this</span>); }
<a name="l00124"></a>00124 
<a name="l00126"></a><a class="code" href="classdai_1_1TFactor.html#f52a4ee1544b4e628390918239b7bc1b">00126</a>         <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> &amp; <a class="code" href="classdai_1_1TFactor.html#f52a4ee1544b4e628390918239b7bc1b" title="Fills all probability entries with random values.">randomize</a> () { _p.randomize(); <span class="keywordflow">return</span>(*<span class="keyword">this</span>); }
<a name="l00127"></a>00127 
<a name="l00129"></a><a class="code" href="classdai_1_1TFactor.html#cf5fc0dd70aa8a7e7c2da3b3acdf6747">00129</a>         <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> <a class="code" href="classdai_1_1TFactor.html#cf5fc0dd70aa8a7e7c2da3b3acdf6747" title="Returns product of *this with x.">operator* </a>(T x)<span class="keyword"> const </span>{
<a name="l00130"></a>00130             <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">Factor</a> result = *<span class="keyword">this</span>;
<a name="l00131"></a>00131             result.<a class="code" href="classdai_1_1TFactor.html#c742180c0abe1be45fbf3208f7014a1b" title="Returns const reference to probability entries.">p</a>() *= x;
<a name="l00132"></a>00132             <span class="keywordflow">return</span> result;
<a name="l00133"></a>00133         }
<a name="l00134"></a>00134 
<a name="l00136"></a><a class="code" href="classdai_1_1TFactor.html#e8a33191e3bc570737ff29e77966c33e">00136</a>         <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a>&amp; <a class="code" href="classdai_1_1TFactor.html#e8a33191e3bc570737ff29e77966c33e" title="Multiplies each probability entry with x.">operator*= </a>(T x) {
<a name="l00137"></a>00137             _p *= x;
<a name="l00138"></a>00138             <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00139"></a>00139         }
<a name="l00140"></a>00140 
<a name="l00142"></a><a class="code" href="classdai_1_1TFactor.html#35fd7313a64a83aba0cd087d1b60289d">00142</a>         <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> <a class="code" href="classdai_1_1TFactor.html#35fd7313a64a83aba0cd087d1b60289d" title="Returns quotient of *this with x.">operator/ </a>(T x)<span class="keyword"> const </span>{
<a name="l00143"></a>00143             <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">Factor</a> result = *<span class="keyword">this</span>;
<a name="l00144"></a>00144             result.<a class="code" href="classdai_1_1TFactor.html#c742180c0abe1be45fbf3208f7014a1b" title="Returns const reference to probability entries.">p</a>() /= x;
<a name="l00145"></a>00145             <span class="keywordflow">return</span> result;
<a name="l00146"></a>00146         }
<a name="l00147"></a>00147 
<a name="l00149"></a><a class="code" href="classdai_1_1TFactor.html#45c34bf15cc9b37e5c0718d96d9d2c1a">00149</a>         <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a>&amp; <a class="code" href="classdai_1_1TFactor.html#45c34bf15cc9b37e5c0718d96d9d2c1a" title="Divides each probability entry by x.">operator/= </a>(T x) {
<a name="l00150"></a>00150             _p /= x;
<a name="l00151"></a>00151             <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00152"></a>00152         }
<a name="l00153"></a>00153 
<a name="l00155"></a>00155         <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> <a class="code" href="classdai_1_1TFactor.html#cf5fc0dd70aa8a7e7c2da3b3acdf6747" title="Returns product of *this with x.">operator* </a>(<span class="keyword">const</span> <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a>&amp; Q) <span class="keyword">const</span>;
<a name="l00156"></a>00156 
<a name="l00158"></a>00158         <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> <a class="code" href="classdai_1_1TFactor.html#35fd7313a64a83aba0cd087d1b60289d" title="Returns quotient of *this with x.">operator/ </a>(<span class="keyword">const</span> <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a>&amp; Q) <span class="keyword">const</span>;
<a name="l00159"></a>00159 
<a name="l00161"></a><a class="code" href="classdai_1_1TFactor.html#914cb4b11fdffa4daaebf645f539d5d1">00161</a>         <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a>&amp; <a class="code" href="classdai_1_1TFactor.html#e8a33191e3bc570737ff29e77966c33e" title="Multiplies each probability entry with x.">operator*= </a>(<span class="keyword">const</span> <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a>&amp; Q) { <span class="keywordflow">return</span>( *<span class="keyword">this</span> = (*<span class="keyword">this</span> * Q) ); }
<a name="l00162"></a>00162 
<a name="l00164"></a><a class="code" href="classdai_1_1TFactor.html#c5ac7c898b536ecbed7a1f58e3899cdb">00164</a>         <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a>&amp; <a class="code" href="classdai_1_1TFactor.html#45c34bf15cc9b37e5c0718d96d9d2c1a" title="Divides each probability entry by x.">operator/= </a>(<span class="keyword">const</span> <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a>&amp; Q) { <span class="keywordflow">return</span>( *<span class="keyword">this</span> = (*<span class="keyword">this</span> / Q) ); }
<a name="l00165"></a>00165 
<a name="l00167"></a><a class="code" href="classdai_1_1TFactor.html#5db00c03b427e577bab01646c451ae23">00167</a>         <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> <a class="code" href="classdai_1_1TFactor.html#5db00c03b427e577bab01646c451ae23" title="Returns sum of *this and another Factor (their vars() should be identical).">operator+ </a>(<span class="keyword">const</span> <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a>&amp; Q)<span class="keyword"> const </span>{
<a name="l00168"></a>00168 <span class="preprocessor">#ifdef DAI_DEBUG</span>
<a name="l00169"></a>00169 <span class="preprocessor"></span>            assert( Q.<a class="code" href="classdai_1_1TFactor.html#b4ba88e0b89d62aa7709852a6cafa9e6">_vs</a> == _vs );
<a name="l00170"></a>00170 <span class="preprocessor">#endif</span>
<a name="l00171"></a>00171 <span class="preprocessor"></span>            <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> sum(*<span class="keyword">this</span>); 
<a name="l00172"></a>00172             sum.<a class="code" href="classdai_1_1TFactor.html#34ea1a358f9248fdcd1d0b68b1313294">_p</a> += Q.<a class="code" href="classdai_1_1TFactor.html#34ea1a358f9248fdcd1d0b68b1313294">_p</a>; 
<a name="l00173"></a>00173             <span class="keywordflow">return</span> sum; 
<a name="l00174"></a>00174         }
<a name="l00175"></a>00175 
<a name="l00177"></a><a class="code" href="classdai_1_1TFactor.html#36cd699efe9bcce52fb21d6a3eb7024a">00177</a>         <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> <a class="code" href="classdai_1_1TFactor.html#36cd699efe9bcce52fb21d6a3eb7024a" title="Returns difference of *this and another Factor (their vars() should be identical)...">operator- </a>(<span class="keyword">const</span> <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a>&amp; Q)<span class="keyword"> const </span>{
<a name="l00178"></a>00178 <span class="preprocessor">#ifdef DAI_DEBUG</span>
<a name="l00179"></a>00179 <span class="preprocessor"></span>            assert( Q.<a class="code" href="classdai_1_1TFactor.html#b4ba88e0b89d62aa7709852a6cafa9e6">_vs</a> == _vs );
<a name="l00180"></a>00180 <span class="preprocessor">#endif</span>
<a name="l00181"></a>00181 <span class="preprocessor"></span>            <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> sum(*<span class="keyword">this</span>); 
<a name="l00182"></a>00182             sum.<a class="code" href="classdai_1_1TFactor.html#34ea1a358f9248fdcd1d0b68b1313294">_p</a> -= Q.<a class="code" href="classdai_1_1TFactor.html#34ea1a358f9248fdcd1d0b68b1313294">_p</a>; 
<a name="l00183"></a>00183             <span class="keywordflow">return</span> sum; 
<a name="l00184"></a>00184         }
<a name="l00185"></a>00185 
<a name="l00187"></a><a class="code" href="classdai_1_1TFactor.html#098a7c22159f23dead9e16ad3dff1e90">00187</a>         <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a>&amp; <a class="code" href="classdai_1_1TFactor.html#098a7c22159f23dead9e16ad3dff1e90" title="Adds another Factor to *this (their vars() should be identical).">operator+= </a>(<span class="keyword">const</span> <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a>&amp; Q) { 
<a name="l00188"></a>00188 <span class="preprocessor">#ifdef DAI_DEBUG</span>
<a name="l00189"></a>00189 <span class="preprocessor"></span>            assert( Q.<a class="code" href="classdai_1_1TFactor.html#b4ba88e0b89d62aa7709852a6cafa9e6">_vs</a> == _vs );
<a name="l00190"></a>00190 <span class="preprocessor">#endif</span>
<a name="l00191"></a>00191 <span class="preprocessor"></span>            _p += Q.<a class="code" href="classdai_1_1TFactor.html#34ea1a358f9248fdcd1d0b68b1313294">_p</a>;
<a name="l00192"></a>00192             <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00193"></a>00193         }
<a name="l00194"></a>00194 
<a name="l00196"></a><a class="code" href="classdai_1_1TFactor.html#a6dd7ae3384f6f329e2cb3c3fa31e514">00196</a>         <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a>&amp; <a class="code" href="classdai_1_1TFactor.html#a6dd7ae3384f6f329e2cb3c3fa31e514" title="Subtracts another Factor from *this (their vars() should be identical).">operator-= </a>(<span class="keyword">const</span> <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a>&amp; Q) { 
<a name="l00197"></a>00197 <span class="preprocessor">#ifdef DAI_DEBUG</span>
<a name="l00198"></a>00198 <span class="preprocessor"></span>            assert( Q.<a class="code" href="classdai_1_1TFactor.html#b4ba88e0b89d62aa7709852a6cafa9e6">_vs</a> == _vs );
<a name="l00199"></a>00199 <span class="preprocessor">#endif</span>
<a name="l00200"></a>00200 <span class="preprocessor"></span>            _p -= Q.<a class="code" href="classdai_1_1TFactor.html#34ea1a358f9248fdcd1d0b68b1313294">_p</a>;
<a name="l00201"></a>00201             <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00202"></a>00202         }
<a name="l00203"></a>00203 
<a name="l00205"></a><a class="code" href="classdai_1_1TFactor.html#fda1418de5d67a6ba004eaea3ef66f77">00205</a>         <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a>&amp; <a class="code" href="classdai_1_1TFactor.html#098a7c22159f23dead9e16ad3dff1e90" title="Adds another Factor to *this (their vars() should be identical).">operator+= </a>(T q) { 
<a name="l00206"></a>00206             _p += q;
<a name="l00207"></a>00207             <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00208"></a>00208         }
<a name="l00209"></a>00209 
<a name="l00211"></a><a class="code" href="classdai_1_1TFactor.html#d74386483d4f28011ddc962db443e3aa">00211</a>         <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a>&amp; <a class="code" href="classdai_1_1TFactor.html#a6dd7ae3384f6f329e2cb3c3fa31e514" title="Subtracts another Factor from *this (their vars() should be identical).">operator-= </a>(T q) { 
<a name="l00212"></a>00212             _p -= q;
<a name="l00213"></a>00213             <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00214"></a>00214         }
<a name="l00215"></a>00215 
<a name="l00217"></a><a class="code" href="classdai_1_1TFactor.html#3c2f95c6fddf19bd871a89f419991c08">00217</a>         <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> <a class="code" href="classdai_1_1TFactor.html#5db00c03b427e577bab01646c451ae23" title="Returns sum of *this and another Factor (their vars() should be identical).">operator+ </a>(T q)<span class="keyword"> const </span>{
<a name="l00218"></a>00218             <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> result(*<span class="keyword">this</span>); 
<a name="l00219"></a>00219             result.<a class="code" href="classdai_1_1TFactor.html#34ea1a358f9248fdcd1d0b68b1313294">_p</a> += q; 
<a name="l00220"></a>00220             <span class="keywordflow">return</span> result; 
<a name="l00221"></a>00221         }
<a name="l00222"></a>00222 
<a name="l00224"></a><a class="code" href="classdai_1_1TFactor.html#171e3bab13b2cd054e8ce1eb97be1112">00224</a>         <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> <a class="code" href="classdai_1_1TFactor.html#36cd699efe9bcce52fb21d6a3eb7024a" title="Returns difference of *this and another Factor (their vars() should be identical)...">operator- </a>(T q)<span class="keyword"> const </span>{
<a name="l00225"></a>00225             <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> result(*<span class="keyword">this</span>); 
<a name="l00226"></a>00226             result.<a class="code" href="classdai_1_1TFactor.html#34ea1a358f9248fdcd1d0b68b1313294">_p</a> -= q; 
<a name="l00227"></a>00227             <span class="keywordflow">return</span> result; 
<a name="l00228"></a>00228         }
<a name="l00229"></a>00229 
<a name="l00231"></a><a class="code" href="classdai_1_1TFactor.html#9b87c70ab153534d5cdbbdba6aaa7921">00231</a>         <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> <a class="code" href="classdai_1_1TFactor.html#9b87c70ab153534d5cdbbdba6aaa7921" title="Returns *this raised to some power.">operator^ </a>(<a class="code" href="namespacedai.html#e7d0472fdc89a8635825d01940e91cbf" title="Real number (alias for double, could be changed to long double if necessary).">Real</a> a)<span class="keyword"> const </span>{ <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> x; x.<a class="code" href="classdai_1_1TFactor.html#b4ba88e0b89d62aa7709852a6cafa9e6">_vs</a> = _vs; x.<a class="code" href="classdai_1_1TFactor.html#34ea1a358f9248fdcd1d0b68b1313294">_p</a> = _p^a; <span class="keywordflow">return</span> x; }
<a name="l00232"></a>00232 
<a name="l00234"></a><a class="code" href="classdai_1_1TFactor.html#4cd8337eb9ae63205692a28435322d3b">00234</a>         <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a>&amp; <a class="code" href="classdai_1_1TFactor.html#4cd8337eb9ae63205692a28435322d3b" title="Raises *this to some power.">operator^= </a>(<a class="code" href="namespacedai.html#e7d0472fdc89a8635825d01940e91cbf" title="Real number (alias for double, could be changed to long double if necessary).">Real</a> a) { _p ^= a; <span class="keywordflow">return</span> *<span class="keyword">this</span>; }
<a name="l00235"></a>00235 
<a name="l00237"></a><a class="code" href="classdai_1_1TFactor.html#8ab0a98ebf512cd5a27e6a2618ed4353">00237</a>         <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a>&amp; <a class="code" href="classdai_1_1TFactor.html#8ab0a98ebf512cd5a27e6a2618ed4353" title="Sets all entries that are smaller than epsilon to zero.">makeZero</a>( <a class="code" href="namespacedai.html#e7d0472fdc89a8635825d01940e91cbf" title="Real number (alias for double, could be changed to long double if necessary).">Real</a> epsilon ) {
<a name="l00238"></a>00238             _p.makeZero( epsilon );
<a name="l00239"></a>00239             <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00240"></a>00240         }
<a name="l00241"></a>00241 
<a name="l00243"></a><a class="code" href="classdai_1_1TFactor.html#731c8683fc17269c4bf3f7b52e0c4b40">00243</a>         <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a>&amp; <a class="code" href="classdai_1_1TFactor.html#731c8683fc17269c4bf3f7b52e0c4b40" title="Sets all entries that are smaller than epsilon to epsilon.">makePositive</a>( <a class="code" href="namespacedai.html#e7d0472fdc89a8635825d01940e91cbf" title="Real number (alias for double, could be changed to long double if necessary).">Real</a> epsilon ) {
<a name="l00244"></a>00244             _p.makePositive( epsilon );
<a name="l00245"></a>00245             <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00246"></a>00246         }
<a name="l00247"></a>00247             
<a name="l00249"></a><a class="code" href="classdai_1_1TFactor.html#de249c30222894e50170a834aca6d708">00249</a>         <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> <a class="code" href="classdai_1_1TFactor.html#de249c30222894e50170a834aca6d708" title="Returns inverse of *this.">inverse</a>()<span class="keyword"> const </span>{ 
<a name="l00250"></a>00250             <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> inv; 
<a name="l00251"></a>00251             inv.<a class="code" href="classdai_1_1TFactor.html#b4ba88e0b89d62aa7709852a6cafa9e6">_vs</a> = _vs; 
<a name="l00252"></a>00252             inv.<a class="code" href="classdai_1_1TFactor.html#34ea1a358f9248fdcd1d0b68b1313294">_p</a> = _p.inverse(<span class="keyword">true</span>);  <span class="comment">// FIXME</span>
<a name="l00253"></a>00253             <span class="keywordflow">return</span> inv; 
<a name="l00254"></a>00254         }
<a name="l00255"></a>00255 
<a name="l00257"></a><a class="code" href="classdai_1_1TFactor.html#1747eaa67d359d34d9221d368753ecdf">00257</a>         <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> <a class="code" href="classdai_1_1TFactor.html#1747eaa67d359d34d9221d368753ecdf" title="Returns *this divided by another Factor.">divided_by</a>( <span class="keyword">const</span> <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a>&amp; denom )<span class="keyword"> const </span>{ 
<a name="l00258"></a>00258 <span class="preprocessor">#ifdef DAI_DEBUG</span>
<a name="l00259"></a>00259 <span class="preprocessor"></span>            assert( denom.<a class="code" href="classdai_1_1TFactor.html#b4ba88e0b89d62aa7709852a6cafa9e6">_vs</a> == _vs );
<a name="l00260"></a>00260 <span class="preprocessor">#endif</span>
<a name="l00261"></a>00261 <span class="preprocessor"></span>            <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> quot(*<span class="keyword">this</span>); 
<a name="l00262"></a>00262             quot.<a class="code" href="classdai_1_1TFactor.html#34ea1a358f9248fdcd1d0b68b1313294">_p</a> /= denom.<a class="code" href="classdai_1_1TFactor.html#34ea1a358f9248fdcd1d0b68b1313294">_p</a>; 
<a name="l00263"></a>00263             <span class="keywordflow">return</span> quot; 
<a name="l00264"></a>00264         }
<a name="l00265"></a>00265 
<a name="l00267"></a><a class="code" href="classdai_1_1TFactor.html#275c1fd149c36a9e67256d21ad97dde1">00267</a>         <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a>&amp; <a class="code" href="classdai_1_1TFactor.html#275c1fd149c36a9e67256d21ad97dde1" title="Divides *this by another Factor.">divide</a>( <span class="keyword">const</span> <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a>&amp; denom ) {
<a name="l00268"></a>00268 <span class="preprocessor">#ifdef DAI_DEBUG</span>
<a name="l00269"></a>00269 <span class="preprocessor"></span>            assert( denom.<a class="code" href="classdai_1_1TFactor.html#b4ba88e0b89d62aa7709852a6cafa9e6">_vs</a> == _vs );
<a name="l00270"></a>00270 <span class="preprocessor">#endif</span>
<a name="l00271"></a>00271 <span class="preprocessor"></span>            _p /= denom.<a class="code" href="classdai_1_1TFactor.html#34ea1a358f9248fdcd1d0b68b1313294">_p</a>;
<a name="l00272"></a>00272             <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00273"></a>00273         }
<a name="l00274"></a>00274 
<a name="l00276"></a><a class="code" href="classdai_1_1TFactor.html#284a962817d33244c261be5d7f0159ca">00276</a>         <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> <a class="code" href="classdai_1_1TFactor.html#284a962817d33244c261be5d7f0159ca" title="Returns exp of *this.">exp</a>()<span class="keyword"> const </span>{ 
<a name="l00277"></a>00277             <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> e; 
<a name="l00278"></a>00278             e.<a class="code" href="classdai_1_1TFactor.html#b4ba88e0b89d62aa7709852a6cafa9e6">_vs</a> = _vs; 
<a name="l00279"></a>00279             e.<a class="code" href="classdai_1_1TFactor.html#34ea1a358f9248fdcd1d0b68b1313294">_p</a> = _p.exp(); 
<a name="l00280"></a>00280             <span class="keywordflow">return</span> e; 
<a name="l00281"></a>00281         }
<a name="l00282"></a>00282 
<a name="l00284"></a><a class="code" href="classdai_1_1TFactor.html#fa3435d85ca11399aba42c63a008765a">00284</a>         <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> <a class="code" href="classdai_1_1TFactor.html#fa3435d85ca11399aba42c63a008765a" title="Returns absolute value of *this.">abs</a>()<span class="keyword"> const </span>{ 
<a name="l00285"></a>00285             <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> e; 
<a name="l00286"></a>00286             e.<a class="code" href="classdai_1_1TFactor.html#b4ba88e0b89d62aa7709852a6cafa9e6">_vs</a> = _vs; 
<a name="l00287"></a>00287             e.<a class="code" href="classdai_1_1TFactor.html#34ea1a358f9248fdcd1d0b68b1313294">_p</a> = _p.abs(); 
<a name="l00288"></a>00288             <span class="keywordflow">return</span> e; 
<a name="l00289"></a>00289         }
<a name="l00290"></a>00290 
<a name="l00292"></a><a class="code" href="classdai_1_1TFactor.html#fbbcf3a69afa5fb3bde1f5a8180860c6">00292</a>         <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> <a class="code" href="classdai_1_1TFactor.html#fbbcf3a69afa5fb3bde1f5a8180860c6" title="Returns logarithm of *this.">log</a>()<span class="keyword"> const </span>{
<a name="l00293"></a>00293             <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> l; 
<a name="l00294"></a>00294             l.<a class="code" href="classdai_1_1TFactor.html#b4ba88e0b89d62aa7709852a6cafa9e6">_vs</a> = _vs; 
<a name="l00295"></a>00295             l.<a class="code" href="classdai_1_1TFactor.html#34ea1a358f9248fdcd1d0b68b1313294">_p</a> = _p.log(); 
<a name="l00296"></a>00296             <span class="keywordflow">return</span> l; 
<a name="l00297"></a>00297         }
<a name="l00298"></a>00298 
<a name="l00300"></a><a class="code" href="classdai_1_1TFactor.html#72b37d26ccac6edb39e71209bb675ba7">00300</a>         <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> <a class="code" href="classdai_1_1TFactor.html#72b37d26ccac6edb39e71209bb675ba7" title="Returns logarithm of *this (defining log(0)=0).">log0</a>()<span class="keyword"> const </span>{
<a name="l00301"></a>00301             <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> l0; 
<a name="l00302"></a>00302             l0.<a class="code" href="classdai_1_1TFactor.html#b4ba88e0b89d62aa7709852a6cafa9e6">_vs</a> = _vs; 
<a name="l00303"></a>00303             l0.<a class="code" href="classdai_1_1TFactor.html#34ea1a358f9248fdcd1d0b68b1313294">_p</a> = _p.log0(); 
<a name="l00304"></a>00304             <span class="keywordflow">return</span> l0; 
<a name="l00305"></a>00305         }
<a name="l00306"></a>00306 
<a name="l00308"></a><a class="code" href="classdai_1_1TFactor.html#c69a94a4d055c3cac107b2a55bb42944">00308</a>         T <a class="code" href="classdai_1_1TFactor.html#c69a94a4d055c3cac107b2a55bb42944" title="Normalizes *this Factor.">normalize</a>( <span class="keyword">typename</span> <a class="code" href="classdai_1_1TProb.html#31d9206096f52574dbd24cbb2502080c" title="Enumerates different ways of normalizing a probability measure.">Prob::NormType</a> norm = Prob::NORMPROB ) { <span class="keywordflow">return</span> _p.normalize( norm ); }
<a name="l00309"></a>00309 
<a name="l00311"></a><a class="code" href="classdai_1_1TFactor.html#df4740f4558ed9bc27029c0c362923e2">00311</a>         <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> <a class="code" href="classdai_1_1TFactor.html#df4740f4558ed9bc27029c0c362923e2" title="Returns a normalized copy of *this.">normalized</a>( <span class="keyword">typename</span> <a class="code" href="classdai_1_1TProb.html#31d9206096f52574dbd24cbb2502080c" title="Enumerates different ways of normalizing a probability measure.">Prob::NormType</a> norm = Prob::NORMPROB )<span class="keyword"> const </span>{ 
<a name="l00312"></a>00312             <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> result;
<a name="l00313"></a>00313             result.<a class="code" href="classdai_1_1TFactor.html#b4ba88e0b89d62aa7709852a6cafa9e6">_vs</a> = _vs;
<a name="l00314"></a>00314             result.<a class="code" href="classdai_1_1TFactor.html#34ea1a358f9248fdcd1d0b68b1313294">_p</a> = _p.normalized( norm );
<a name="l00315"></a>00315             <span class="keywordflow">return</span> result;
<a name="l00316"></a>00316         }
<a name="l00317"></a>00317 
<a name="l00319"></a><a class="code" href="classdai_1_1TFactor.html#7cc9e6bca2b9c187f8d907942264508f">00319</a>         <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">Factor</a> <a class="code" href="classdai_1_1TFactor.html#7cc9e6bca2b9c187f8d907942264508f" title="Returns a slice of this factor, where the subset ns is in state ns_state.">slice</a>( <span class="keyword">const</span> <a class="code" href="classdai_1_1VarSet.html" title="Represents a set of variables.">VarSet</a> &amp; ns, <span class="keywordtype">size_t</span> ns_state )<span class="keyword"> const </span>{
<a name="l00320"></a>00320             assert( ns &lt;&lt; _vs );
<a name="l00321"></a>00321             <a class="code" href="classdai_1_1VarSet.html" title="Represents a set of variables.">VarSet</a> nsrem = _vs / ns;
<a name="l00322"></a>00322             <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">Factor</a> result( nsrem, 0.0 );
<a name="l00323"></a>00323             
<a name="l00324"></a>00324             <span class="comment">// OPTIMIZE ME</span>
<a name="l00325"></a>00325             <a class="code" href="classdai_1_1IndexFor.html" title="Tool for looping over the states of several variables.">IndexFor</a> i_ns (ns, _vs);
<a name="l00326"></a>00326             <a class="code" href="classdai_1_1IndexFor.html" title="Tool for looping over the states of several variables.">IndexFor</a> i_nsrem (nsrem, _vs);
<a name="l00327"></a>00327             <span class="keywordflow">for</span>( <span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classdai_1_1TFactor.html#57d676927a5dcacbef47f564c46bf128" title="Returns the number of possible joint states of the variables.">states</a>(); i++, ++i_ns, ++i_nsrem )
<a name="l00328"></a>00328                 <span class="keywordflow">if</span>( (<span class="keywordtype">size_t</span>)i_ns == ns_state )
<a name="l00329"></a>00329                     result.<a class="code" href="classdai_1_1TFactor.html#34ea1a358f9248fdcd1d0b68b1313294">_p</a>[i_nsrem] = _p[i];
<a name="l00330"></a>00330 
<a name="l00331"></a>00331             <span class="keywordflow">return</span> result;
<a name="l00332"></a>00332         }
<a name="l00333"></a>00333 
<a name="l00335"></a>00335         <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> <a class="code" href="classdai_1_1TFactor.html#f90e2a8a5ef94809ae8905e19fc523e4" title="Returns unnormalized marginal; ns should be a subset of vars().">partSum</a>(<span class="keyword">const</span> <a class="code" href="classdai_1_1VarSet.html" title="Represents a set of variables.">VarSet</a> &amp; ns) <span class="keyword">const</span>;
<a name="l00336"></a>00336 
<a name="l00338"></a><a class="code" href="classdai_1_1TFactor.html#692df5b8aed5f6faeb60e076624d5854">00338</a>         <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> <a class="code" href="classdai_1_1TFactor.html#692df5b8aed5f6faeb60e076624d5854" title="Returns (normalized by default) marginal; ns should be a subset of vars().">marginal</a>(<span class="keyword">const</span> <a class="code" href="classdai_1_1VarSet.html" title="Represents a set of variables.">VarSet</a> &amp; ns, <span class="keywordtype">bool</span> normed = <span class="keyword">true</span>)<span class="keyword"> const </span>{ <span class="keywordflow">if</span>(normed) <span class="keywordflow">return</span> <a class="code" href="classdai_1_1TFactor.html#f90e2a8a5ef94809ae8905e19fc523e4" title="Returns unnormalized marginal; ns should be a subset of vars().">partSum</a>(ns).normalized(); <span class="keywordflow">else</span> <span class="keywordflow">return</span> <a class="code" href="classdai_1_1TFactor.html#f90e2a8a5ef94809ae8905e19fc523e4" title="Returns unnormalized marginal; ns should be a subset of vars().">partSum</a>(ns); }
<a name="l00339"></a>00339 
<a name="l00341"></a><a class="code" href="classdai_1_1TFactor.html#fd92183f10a4214341ce771b02f8744d">00341</a>         <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> <a class="code" href="classdai_1_1TFactor.html#fd92183f10a4214341ce771b02f8744d" title="Sums out all variables except those in ns.">notSum</a>(<span class="keyword">const</span> <a class="code" href="classdai_1_1VarSet.html" title="Represents a set of variables.">VarSet</a> &amp; ns)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classdai_1_1TFactor.html#f90e2a8a5ef94809ae8905e19fc523e4" title="Returns unnormalized marginal; ns should be a subset of vars().">partSum</a>(<a class="code" href="classdai_1_1TFactor.html#54c575d53b8c8a6a03c26c8cdc600ce4" title="Returns const reference to variables.">vars</a>() ^ ns); }
<a name="l00342"></a>00342 
<a name="l00344"></a><a class="code" href="classdai_1_1TFactor.html#81c344b9e204bb57aaca92c281aa7dd3">00344</a>         <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> <a class="code" href="classdai_1_1TFactor.html#81c344b9e204bb57aaca92c281aa7dd3" title="Embeds this factor in a larger VarSet.">embed</a>(<span class="keyword">const</span> <a class="code" href="classdai_1_1VarSet.html" title="Represents a set of variables.">VarSet</a> &amp; ns)<span class="keyword"> const </span>{ 
<a name="l00345"></a>00345             <a class="code" href="classdai_1_1VarSet.html" title="Represents a set of variables.">VarSet</a> vs = <a class="code" href="classdai_1_1TFactor.html#54c575d53b8c8a6a03c26c8cdc600ce4" title="Returns const reference to variables.">vars</a>();
<a name="l00346"></a>00346             assert( ns &gt;&gt; vs );
<a name="l00347"></a>00347             <span class="keywordflow">if</span>( vs == ns )
<a name="l00348"></a>00348                 <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00349"></a>00349             <span class="keywordflow">else</span>
<a name="l00350"></a>00350                 <span class="keywordflow">return</span> (*<span class="keyword">this</span>) * <a class="code" href="namespacedai.html#7515abf9952cd312e95a34ada0670e85" title="Represents a factor with probability entries represented as Real.">Factor</a>(ns / vs, 1.0);
<a name="l00351"></a>00351         }
<a name="l00352"></a>00352 
<a name="l00354"></a><a class="code" href="classdai_1_1TFactor.html#dafb816c6d9f93ceea858709391841d2">00354</a>         <span class="keywordtype">bool</span> <a class="code" href="classdai_1_1TFactor.html#dafb816c6d9f93ceea858709391841d2" title="Returns true if *this has NANs.">hasNaNs</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _p.hasNaNs(); }
<a name="l00355"></a>00355 
<a name="l00357"></a><a class="code" href="classdai_1_1TFactor.html#7353d87f8a1d4c6c24b9cc5de7b18219">00357</a>         <span class="keywordtype">bool</span> <a class="code" href="classdai_1_1TFactor.html#7353d87f8a1d4c6c24b9cc5de7b18219" title="Returns true if *this has negative entries.">hasNegatives</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _p.hasNegatives(); }
<a name="l00358"></a>00358 
<a name="l00360"></a><a class="code" href="classdai_1_1TFactor.html#aff9f62e6ef5792a459946cd81bd35af">00360</a>         T <a class="code" href="classdai_1_1TFactor.html#aff9f62e6ef5792a459946cd81bd35af" title="Returns total sum of probability entries.">totalSum</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _p.totalSum(); }
<a name="l00361"></a>00361 
<a name="l00363"></a><a class="code" href="classdai_1_1TFactor.html#8e67b044dfaebf20c77031a2378e65f5">00363</a>         T <a class="code" href="classdai_1_1TFactor.html#8e67b044dfaebf20c77031a2378e65f5" title="Returns maximum absolute value of probability entries.">maxAbs</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _p.maxAbs(); }
<a name="l00364"></a>00364 
<a name="l00366"></a><a class="code" href="classdai_1_1TFactor.html#160c82f59a3202180025853a9e5caaa5">00366</a>         T <a class="code" href="classdai_1_1TFactor.html#160c82f59a3202180025853a9e5caaa5" title="Returns maximum value of probability entries.">maxVal</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _p.maxVal(); }
<a name="l00367"></a>00367 
<a name="l00369"></a><a class="code" href="classdai_1_1TFactor.html#891e98fd0cd9f65f945eb5733c6c3e9f">00369</a>         T <a class="code" href="classdai_1_1TFactor.html#891e98fd0cd9f65f945eb5733c6c3e9f" title="Returns minimum value of probability entries.">minVal</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _p.minVal(); }
<a name="l00370"></a>00370 
<a name="l00372"></a><a class="code" href="classdai_1_1TFactor.html#948c0013f741040ecdcad7da53377268">00372</a>         <a class="code" href="namespacedai.html#e7d0472fdc89a8635825d01940e91cbf" title="Real number (alias for double, could be changed to long double if necessary).">Real</a> <a class="code" href="classdai_1_1TFactor.html#948c0013f741040ecdcad7da53377268" title="Returns entropy of *this.">entropy</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _p.entropy(); }
<a name="l00373"></a>00373 
<a name="l00375"></a>00375         T <a class="code" href="classdai_1_1TFactor.html#4908ad29222b60d669d234d0805605b8" title="Returns strength of *this, between variables i and j, using (52) of [MoK07b].">strength</a>( <span class="keyword">const</span> <a class="code" href="classdai_1_1Var.html" title="Represents a discrete random variable.">Var</a> &amp;i, <span class="keyword">const</span> <a class="code" href="classdai_1_1Var.html" title="Represents a discrete random variable.">Var</a> &amp;j ) <span class="keyword">const</span>;
<a name="l00376"></a>00376 };
<a name="l00377"></a>00377 
<a name="l00378"></a>00378 
<a name="l00379"></a><a class="code" href="classdai_1_1TFactor.html#f90e2a8a5ef94809ae8905e19fc523e4">00379</a> <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;::partSum</a>(<span class="keyword">const</span> <a class="code" href="classdai_1_1VarSet.html" title="Represents a set of variables.">VarSet</a> &amp; ns)<span class="keyword"> const </span>{
<a name="l00380"></a>00380 <span class="preprocessor">#ifdef DAI_DEBUG</span>
<a name="l00381"></a>00381 <span class="preprocessor"></span>    assert( ns &lt;&lt; _vs );
<a name="l00382"></a>00382 <span class="preprocessor">#endif</span>
<a name="l00383"></a>00383 <span class="preprocessor"></span>
<a name="l00384"></a>00384     <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> res( ns, 0.0 );
<a name="l00385"></a>00385 
<a name="l00386"></a>00386     <a class="code" href="classdai_1_1IndexFor.html" title="Tool for looping over the states of several variables.">IndexFor</a> i_res( ns, _vs );
<a name="l00387"></a>00387     <span class="keywordflow">for</span>( <span class="keywordtype">size_t</span> i = 0; i &lt; _p.size(); i++, ++i_res )
<a name="l00388"></a>00388         res.<a class="code" href="classdai_1_1TFactor.html#34ea1a358f9248fdcd1d0b68b1313294">_p</a>[i_res] += _p[i];
<a name="l00389"></a>00389 
<a name="l00390"></a>00390     <span class="keywordflow">return</span> res;
<a name="l00391"></a>00391 }
<a name="l00392"></a>00392 
<a name="l00393"></a>00393 
<a name="l00394"></a><a class="code" href="classdai_1_1TFactor.html#53f052f85f5274b783eaa1ecd31a6b35">00394</a> <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;::operator* </a>(<span class="keyword">const</span> <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a>&amp; Q)<span class="keyword"> const </span>{
<a name="l00395"></a>00395     <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> prod( _vs | Q.<a class="code" href="classdai_1_1TFactor.html#b4ba88e0b89d62aa7709852a6cafa9e6">_vs</a>, 0.0 );
<a name="l00396"></a>00396 
<a name="l00397"></a>00397     <a class="code" href="classdai_1_1IndexFor.html" title="Tool for looping over the states of several variables.">IndexFor</a> i1(_vs, prod.<a class="code" href="classdai_1_1TFactor.html#b4ba88e0b89d62aa7709852a6cafa9e6">_vs</a>);
<a name="l00398"></a>00398     <a class="code" href="classdai_1_1IndexFor.html" title="Tool for looping over the states of several variables.">IndexFor</a> i2(Q.<a class="code" href="classdai_1_1TFactor.html#b4ba88e0b89d62aa7709852a6cafa9e6">_vs</a>, prod.<a class="code" href="classdai_1_1TFactor.html#b4ba88e0b89d62aa7709852a6cafa9e6">_vs</a>);
<a name="l00399"></a>00399 
<a name="l00400"></a>00400     <span class="keywordflow">for</span>( <span class="keywordtype">size_t</span> i = 0; i &lt; prod.<a class="code" href="classdai_1_1TFactor.html#34ea1a358f9248fdcd1d0b68b1313294">_p</a>.size(); i++, ++i1, ++i2 )
<a name="l00401"></a>00401         prod.<a class="code" href="classdai_1_1TFactor.html#34ea1a358f9248fdcd1d0b68b1313294">_p</a>[i] += _p[i1] * Q.<a class="code" href="classdai_1_1TFactor.html#34ea1a358f9248fdcd1d0b68b1313294">_p</a>[i2];
<a name="l00402"></a>00402 
<a name="l00403"></a>00403     <span class="keywordflow">return</span> prod;
<a name="l00404"></a>00404 }
<a name="l00405"></a>00405 
<a name="l00406"></a>00406 
<a name="l00407"></a><a class="code" href="classdai_1_1TFactor.html#f5894eb556d2c440774e650102207d80">00407</a> <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;::operator/ </a>(<span class="keyword">const</span> <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a>&amp; Q)<span class="keyword"> const </span>{
<a name="l00408"></a>00408     <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> quot( _vs + Q.<a class="code" href="classdai_1_1TFactor.html#b4ba88e0b89d62aa7709852a6cafa9e6">_vs</a>, 0.0 );
<a name="l00409"></a>00409 
<a name="l00410"></a>00410     <a class="code" href="classdai_1_1IndexFor.html" title="Tool for looping over the states of several variables.">IndexFor</a> i1(_vs, quot.<a class="code" href="classdai_1_1TFactor.html#b4ba88e0b89d62aa7709852a6cafa9e6">_vs</a>);
<a name="l00411"></a>00411     <a class="code" href="classdai_1_1IndexFor.html" title="Tool for looping over the states of several variables.">IndexFor</a> i2(Q.<a class="code" href="classdai_1_1TFactor.html#b4ba88e0b89d62aa7709852a6cafa9e6">_vs</a>, quot.<a class="code" href="classdai_1_1TFactor.html#b4ba88e0b89d62aa7709852a6cafa9e6">_vs</a>);
<a name="l00412"></a>00412 
<a name="l00413"></a>00413     <span class="keywordflow">for</span>( <span class="keywordtype">size_t</span> i = 0; i &lt; quot.<a class="code" href="classdai_1_1TFactor.html#34ea1a358f9248fdcd1d0b68b1313294">_p</a>.size(); i++, ++i1, ++i2 )
<a name="l00414"></a>00414         quot.<a class="code" href="classdai_1_1TFactor.html#34ea1a358f9248fdcd1d0b68b1313294">_p</a>[i] += _p[i1] / Q.<a class="code" href="classdai_1_1TFactor.html#34ea1a358f9248fdcd1d0b68b1313294">_p</a>[i2];
<a name="l00415"></a>00415 
<a name="l00416"></a>00416     <span class="keywordflow">return</span> quot;
<a name="l00417"></a>00417 }
<a name="l00418"></a>00418 
<a name="l00419"></a>00419 
<a name="l00420"></a><a class="code" href="classdai_1_1TFactor.html#4908ad29222b60d669d234d0805605b8">00420</a> <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; T <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;::strength</a>( <span class="keyword">const</span> <a class="code" href="classdai_1_1Var.html" title="Represents a discrete random variable.">Var</a> &amp;i, <span class="keyword">const</span> <a class="code" href="classdai_1_1Var.html" title="Represents a discrete random variable.">Var</a> &amp;j )<span class="keyword"> const </span>{
<a name="l00421"></a>00421 <span class="preprocessor">#ifdef DAI_DEBUG</span>
<a name="l00422"></a>00422 <span class="preprocessor"></span>    assert( _vs.<a class="code" href="classdai_1_1smallSet.html#82eff80e70adf8c0a541c0a505522b32" title="Returns true if *this contains the element n.">contains</a>( i ) );
<a name="l00423"></a>00423     assert( _vs.<a class="code" href="classdai_1_1smallSet.html#82eff80e70adf8c0a541c0a505522b32" title="Returns true if *this contains the element n.">contains</a>( j ) );
<a name="l00424"></a>00424     assert( i != j );
<a name="l00425"></a>00425 <span class="preprocessor">#endif</span>
<a name="l00426"></a>00426 <span class="preprocessor"></span>    <a class="code" href="classdai_1_1VarSet.html" title="Represents a set of variables.">VarSet</a> ij(i, j);
<a name="l00427"></a>00427 
<a name="l00428"></a>00428     T <a class="code" href="namespacedai.html#26014cccb4cc16b53e83d350e280a705" title="Returns the pointwise maximum of two Factors.">max</a> = 0.0;
<a name="l00429"></a>00429     <span class="keywordflow">for</span>( <span class="keywordtype">size_t</span> alpha1 = 0; alpha1 &lt; i.<a class="code" href="classdai_1_1Var.html#41f8d939741336bca2080bedfaf92302" title="Returns the number of states.">states</a>(); alpha1++ )
<a name="l00430"></a>00430         <span class="keywordflow">for</span>( <span class="keywordtype">size_t</span> alpha2 = 0; alpha2 &lt; i.<a class="code" href="classdai_1_1Var.html#41f8d939741336bca2080bedfaf92302" title="Returns the number of states.">states</a>(); alpha2++ )
<a name="l00431"></a>00431             <span class="keywordflow">if</span>( alpha2 != alpha1 )
<a name="l00432"></a>00432                 <span class="keywordflow">for</span>( <span class="keywordtype">size_t</span> beta1 = 0; beta1 &lt; j.<a class="code" href="classdai_1_1Var.html#41f8d939741336bca2080bedfaf92302" title="Returns the number of states.">states</a>(); beta1++ ) 
<a name="l00433"></a>00433                     <span class="keywordflow">for</span>( <span class="keywordtype">size_t</span> beta2 = 0; beta2 &lt; j.<a class="code" href="classdai_1_1Var.html#41f8d939741336bca2080bedfaf92302" title="Returns the number of states.">states</a>(); beta2++ )
<a name="l00434"></a>00434                         <span class="keywordflow">if</span>( beta2 != beta1 ) {
<a name="l00435"></a>00435                             <span class="keywordtype">size_t</span> as = 1, bs = 1;
<a name="l00436"></a>00436                             <span class="keywordflow">if</span>( i &lt; j )
<a name="l00437"></a>00437                                 bs = i.<a class="code" href="classdai_1_1Var.html#41f8d939741336bca2080bedfaf92302" title="Returns the number of states.">states</a>();
<a name="l00438"></a>00438                             <span class="keywordflow">else</span>
<a name="l00439"></a>00439                                 as = j.<a class="code" href="classdai_1_1Var.html#41f8d939741336bca2080bedfaf92302" title="Returns the number of states.">states</a>();
<a name="l00440"></a>00440                             T f1 = <a class="code" href="classdai_1_1TFactor.html#7cc9e6bca2b9c187f8d907942264508f" title="Returns a slice of this factor, where the subset ns is in state ns_state.">slice</a>( ij, alpha1 * as + beta1 * bs ).<a class="code" href="classdai_1_1TFactor.html#c742180c0abe1be45fbf3208f7014a1b" title="Returns const reference to probability entries.">p</a>().divide( <a class="code" href="classdai_1_1TFactor.html#7cc9e6bca2b9c187f8d907942264508f" title="Returns a slice of this factor, where the subset ns is in state ns_state.">slice</a>( ij, alpha2 * as + beta1 * bs ).<a class="code" href="classdai_1_1TFactor.html#c742180c0abe1be45fbf3208f7014a1b" title="Returns const reference to probability entries.">p</a>() ).maxVal();
<a name="l00441"></a>00441                             T f2 = <a class="code" href="classdai_1_1TFactor.html#7cc9e6bca2b9c187f8d907942264508f" title="Returns a slice of this factor, where the subset ns is in state ns_state.">slice</a>( ij, alpha2 * as + beta2 * bs ).<a class="code" href="classdai_1_1TFactor.html#c742180c0abe1be45fbf3208f7014a1b" title="Returns const reference to probability entries.">p</a>().divide( <a class="code" href="classdai_1_1TFactor.html#7cc9e6bca2b9c187f8d907942264508f" title="Returns a slice of this factor, where the subset ns is in state ns_state.">slice</a>( ij, alpha1 * as + beta2 * bs ).<a class="code" href="classdai_1_1TFactor.html#c742180c0abe1be45fbf3208f7014a1b" title="Returns const reference to probability entries.">p</a>() ).maxVal();
<a name="l00442"></a>00442                             T f = f1 * f2;
<a name="l00443"></a>00443                             <span class="keywordflow">if</span>( f &gt; max )
<a name="l00444"></a>00444                                 max = f;
<a name="l00445"></a>00445                         }
<a name="l00446"></a>00446     
<a name="l00447"></a>00447     <span class="keywordflow">return</span> std::tanh( 0.25 * std::log( max ) );
<a name="l00448"></a>00448 }
<a name="l00449"></a>00449 
<a name="l00450"></a>00450 
<a name="l00452"></a><a class="code" href="namespacedai.html#dbcd0bf0cd16bda03f4483530611dbae">00452</a> <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; std::ostream&amp; operator&lt;&lt; (std::ostream&amp; os, const TFactor&lt;T&gt;&amp; P) {
<a name="l00453"></a>00453     os &lt;&lt; <span class="stringliteral">"("</span> &lt;&lt; P.vars() &lt;&lt; <span class="stringliteral">" &lt;"</span>;
<a name="l00454"></a>00454     <span class="keywordflow">for</span>( <span class="keywordtype">size_t</span> i = 0; i &lt; P.states(); i++ )
<a name="l00455"></a>00455         os &lt;&lt; P[i] &lt;&lt; <span class="stringliteral">" "</span>;
<a name="l00456"></a>00456     os &lt;&lt; <span class="stringliteral">"&gt;)"</span>;
<a name="l00457"></a>00457     <span class="keywordflow">return</span> os;
<a name="l00458"></a>00458 }
<a name="l00459"></a>00459 
<a name="l00460"></a>00460 
<a name="l00462"></a><a class="code" href="namespacedai.html#21104476f853192821ff6685732ac0af">00462</a> <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <a class="code" href="namespacedai.html#e7d0472fdc89a8635825d01940e91cbf" title="Real number (alias for double, could be changed to long double if necessary).">Real</a> <a class="code" href="namespacedai.html#21104476f853192821ff6685732ac0af" title="Returns distance between two Factors (with identical vars()).">dist</a>( <span class="keyword">const</span> <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> &amp; x, <span class="keyword">const</span> <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> &amp; y, <a class="code" href="classdai_1_1TProb.html#492487fd71f6e87673853e5e2fda2f27" title="Enumerates different distance measures between probability measures.">Prob::DistType</a> dt ) {
<a name="l00463"></a>00463     <span class="keywordflow">if</span>( x.<a class="code" href="classdai_1_1TFactor.html#54c575d53b8c8a6a03c26c8cdc600ce4" title="Returns const reference to variables.">vars</a>().<a class="code" href="classdai_1_1smallSet.html#b405901de2feb12ff027b973a234a39c" title="Returns whether the smallSet is empty.">empty</a>() || y.<a class="code" href="classdai_1_1TFactor.html#54c575d53b8c8a6a03c26c8cdc600ce4" title="Returns const reference to variables.">vars</a>().<a class="code" href="classdai_1_1smallSet.html#b405901de2feb12ff027b973a234a39c" title="Returns whether the smallSet is empty.">empty</a>() )
<a name="l00464"></a>00464         <span class="keywordflow">return</span> -1;
<a name="l00465"></a>00465     <span class="keywordflow">else</span> {
<a name="l00466"></a>00466 <span class="preprocessor">#ifdef DAI_DEBUG</span>
<a name="l00467"></a>00467 <span class="preprocessor"></span>        assert( x.<a class="code" href="classdai_1_1TFactor.html#54c575d53b8c8a6a03c26c8cdc600ce4" title="Returns const reference to variables.">vars</a>() == y.<a class="code" href="classdai_1_1TFactor.html#54c575d53b8c8a6a03c26c8cdc600ce4" title="Returns const reference to variables.">vars</a>() );
<a name="l00468"></a>00468 <span class="preprocessor">#endif</span>
<a name="l00469"></a>00469 <span class="preprocessor"></span>        <span class="keywordflow">return</span> <a class="code" href="namespacedai.html#21104476f853192821ff6685732ac0af" title="Returns distance between two Factors (with identical vars()).">dist</a>( x.<a class="code" href="classdai_1_1TFactor.html#c742180c0abe1be45fbf3208f7014a1b" title="Returns const reference to probability entries.">p</a>(), y.<a class="code" href="classdai_1_1TFactor.html#c742180c0abe1be45fbf3208f7014a1b" title="Returns const reference to probability entries.">p</a>(), dt );
<a name="l00470"></a>00470     }
<a name="l00471"></a>00471 }
<a name="l00472"></a>00472 
<a name="l00473"></a>00473 
<a name="l00475"></a><a class="code" href="namespacedai.html#26014cccb4cc16b53e83d350e280a705">00475</a> <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> <a class="code" href="namespacedai.html#26014cccb4cc16b53e83d350e280a705" title="Returns the pointwise maximum of two Factors.">max</a>( <span class="keyword">const</span> <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> &amp; P, <span class="keyword">const</span> <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> &amp; Q ) {
<a name="l00476"></a>00476     assert( P.<a class="code" href="classdai_1_1TFactor.html#b4ba88e0b89d62aa7709852a6cafa9e6">_vs</a> == Q.<a class="code" href="classdai_1_1TFactor.html#b4ba88e0b89d62aa7709852a6cafa9e6">_vs</a> );
<a name="l00477"></a>00477     <span class="keywordflow">return</span> <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a>( P.<a class="code" href="classdai_1_1TFactor.html#b4ba88e0b89d62aa7709852a6cafa9e6">_vs</a>, <a class="code" href="namespacedai.html#0957f2d605d64a2e13b8dc3eb9fc8800" title="Returns the pointwise minimum of two Factors.">min</a>( P.<a class="code" href="classdai_1_1TFactor.html#c742180c0abe1be45fbf3208f7014a1b" title="Returns const reference to probability entries.">p</a>(), Q.<a class="code" href="classdai_1_1TFactor.html#c742180c0abe1be45fbf3208f7014a1b" title="Returns const reference to probability entries.">p</a>() ) );
<a name="l00478"></a>00478 }
<a name="l00479"></a>00479 
<a name="l00480"></a>00480 
<a name="l00482"></a><a class="code" href="namespacedai.html#0957f2d605d64a2e13b8dc3eb9fc8800">00482</a> <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> <a class="code" href="namespacedai.html#0957f2d605d64a2e13b8dc3eb9fc8800" title="Returns the pointwise minimum of two Factors.">min</a>( <span class="keyword">const</span> <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> &amp; P, <span class="keyword">const</span> <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> &amp; Q ) {
<a name="l00483"></a>00483     assert( P.<a class="code" href="classdai_1_1TFactor.html#b4ba88e0b89d62aa7709852a6cafa9e6">_vs</a> == Q.<a class="code" href="classdai_1_1TFactor.html#b4ba88e0b89d62aa7709852a6cafa9e6">_vs</a> );
<a name="l00484"></a>00484     <span class="keywordflow">return</span> <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a>( P.<a class="code" href="classdai_1_1TFactor.html#b4ba88e0b89d62aa7709852a6cafa9e6">_vs</a>, <a class="code" href="namespacedai.html#26014cccb4cc16b53e83d350e280a705" title="Returns the pointwise maximum of two Factors.">max</a>( P.<a class="code" href="classdai_1_1TFactor.html#c742180c0abe1be45fbf3208f7014a1b" title="Returns const reference to probability entries.">p</a>(), Q.<a class="code" href="classdai_1_1TFactor.html#c742180c0abe1be45fbf3208f7014a1b" title="Returns const reference to probability entries.">p</a>() ) );
<a name="l00485"></a>00485 }
<a name="l00486"></a>00486 
<a name="l00487"></a>00487 
<a name="l00489"></a><a class="code" href="namespacedai.html#716237fb73c302a0ee0d3e334d71517c">00489</a> <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <a class="code" href="namespacedai.html#e7d0472fdc89a8635825d01940e91cbf" title="Real number (alias for double, could be changed to long double if necessary).">Real</a> <a class="code" href="namespacedai.html#716237fb73c302a0ee0d3e334d71517c" title="Calculates the mutual information between the two variables in P.">MutualInfo</a>(<span class="keyword">const</span> <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> &amp; P) {
<a name="l00490"></a>00490     assert( P.<a class="code" href="classdai_1_1TFactor.html#54c575d53b8c8a6a03c26c8cdc600ce4" title="Returns const reference to variables.">vars</a>().<a class="code" href="classdai_1_1smallSet.html#39b00df453666d22331e932d3b7a2f16" title="Returns number of elements.">size</a>() == 2 );
<a name="l00491"></a>00491     <a class="code" href="classdai_1_1smallSet.html#103c819872818d14a7234a1f618a815c" title="Constant iterator over the elements.">VarSet::const_iterator</a> it = P.<a class="code" href="classdai_1_1TFactor.html#54c575d53b8c8a6a03c26c8cdc600ce4" title="Returns const reference to variables.">vars</a>().<a class="code" href="classdai_1_1smallSet.html#6a14836b896a8bb1901ea79fd45394d0" title="Returns iterator that points to the first element.">begin</a>();
<a name="l00492"></a>00492     <a class="code" href="classdai_1_1Var.html" title="Represents a discrete random variable.">Var</a> i = *it; it++; <a class="code" href="classdai_1_1Var.html" title="Represents a discrete random variable.">Var</a> j = *it;
<a name="l00493"></a>00493     <a class="code" href="classdai_1_1TFactor.html" title="Represents a probability factor.">TFactor&lt;T&gt;</a> projection = P.<a class="code" href="classdai_1_1TFactor.html#692df5b8aed5f6faeb60e076624d5854" title="Returns (normalized by default) marginal; ns should be a subset of vars().">marginal</a>(i) * P.<a class="code" href="classdai_1_1TFactor.html#692df5b8aed5f6faeb60e076624d5854" title="Returns (normalized by default) marginal; ns should be a subset of vars().">marginal</a>(j);
<a name="l00494"></a>00494     <span class="keywordflow">return</span> real( <a class="code" href="namespacedai.html#21104476f853192821ff6685732ac0af" title="Returns distance between two Factors (with identical vars()).">dist</a>( P.<a class="code" href="classdai_1_1TFactor.html#df4740f4558ed9bc27029c0c362923e2" title="Returns a normalized copy of *this.">normalized</a>(), projection, Prob::DISTKL ) );
<a name="l00495"></a>00495 }
<a name="l00496"></a>00496 
<a name="l00497"></a>00497 
<a name="l00498"></a>00498 } <span class="comment">// end of namespace dai</span>
<a name="l00499"></a>00499 
<a name="l00500"></a>00500 
<a name="l00501"></a>00501 <span class="preprocessor">#endif</span>
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Wed Jun 8 10:17:04 2011 for libDAI by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
